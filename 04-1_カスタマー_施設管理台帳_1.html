<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>設備管理台帳システム - エネルギーサービス企業</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .card-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px -3px rgba(0, 0, 0, 0.15);
    }
    .card-hover {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .status-normal { background: linear-gradient(135deg, #10b981, #065f46); color: white; }
    .status-warning { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
    .status-critical { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
    .status-maintenance { background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; }
    
    .equipment-card {
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      border: 1px solid #e2e8f0;
      border-radius: 16px;
      transition: all 0.3s ease;
    }
    .equipment-card:hover {
      border-color: #3b82f6;
      box-shadow: 0 8px 25px -5px rgba(59, 130, 246, 0.15);
    }
    
    .timeline-item::before {
      content: '';
      position: absolute;
      left: 20px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: linear-gradient(to bottom, #e5e7eb, #d1d5db);
    }
    .timeline-item:last-child::before {
      background: linear-gradient(to bottom, #e5e7eb 50%, transparent 50%);
    }
    
    .warranty-gauge {
      background: conic-gradient(from 0deg, #ef4444 0%, #f59e0b 30%, #10b981 70%, #10b981 100%);
      border-radius: 50%;
      position: relative;
    }
    
    .warranty-gauge::before {
      content: '';
      position: absolute;
      top: 4px;
      left: 4px;
      right: 4px;
      bottom: 4px;
      background: white;
      border-radius: 50%;
    }
    
    .specification-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }
    
    .maintenance-alert {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border-left: 4px solid #f59e0b;
    }
    
    .critical-alert {
      background: linear-gradient(135deg, #fecaca, #fca5a5);
      border-left: 4px solid #ef4444;
    }
    
    .filter-chip {
      background: #f1f5f9;
      border: 1px solid #cbd5e1;
      border-radius: 20px;
      padding: 4px 12px;
      font-size: 0.875rem;
      transition: all 0.2s;
    }
    .filter-chip.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    .filter-chip:hover {
      background: #e2e8f0;
      border-color: #94a3b8;
    }
    .filter-chip.active:hover {
      background: #2563eb;
    }
    
    .equipment-status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 8px;
    }
    .status-good { background: #10b981; }
    .status-caution { background: #f59e0b; }
    .status-alert { background: #ef4444; }
    .status-offline { background: #6b7280; }
    
    .parts-inventory {
      background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
      border: 1px solid #0ea5e9;
      border-radius: 8px;
    }
    
    .qr-scanner {
      background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
      border: 2px dashed #9ca3af;
      border-radius: 12px;
      transition: all 0.3s ease;
    }
    .qr-scanner:hover {
      border-color: #3b82f6;
      background: linear-gradient(135deg, #dbeafe, #bfdbfe);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-100 to-blue-50 min-h-screen">
  <!-- ヘッダーセクション -->
  <header class="bg-gradient-to-r from-green-800 to-emerald-900 text-white shadow-xl">
    <div class="container mx-auto px-4 py-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center">
          <div class="flex items-center mr-6">
            <i class="fas fa-cogs text-2xl mr-3"></i>
            <div>
              <h1 class="text-2xl font-bold">設備管理台帳システム</h1>
              <p class="text-green-200 text-sm">Equipment Registry Management System</p>
            </div>
          </div>
          <div class="flex items-center space-x-4">
            <span class="bg-green-700 px-3 py-1 rounded-full text-sm font-medium">カスタマー部門専用</span>
            <div class="text-center">
              <div class="text-xs text-green-200">管理設備数</div>
              <div class="text-lg font-bold text-white">1,247台</div>
            </div>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <!-- QRスキャナー -->
          <button class="p-2 hover:bg-green-700 rounded-full transition-colors" onclick="openQRScanner()">
            <i class="fas fa-qrcode text-xl"></i>
          </button>
          <!-- 通知 -->
          <div class="relative">
            <button class="p-2 hover:bg-green-700 rounded-full transition-colors" onclick="showNotification('メンテナンス期限が近い設備が5台あります', 'warning')">
              <i class="fas fa-bell text-xl"></i>
              <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center">5</span>
            </button>
          </div>
          <!-- ユーザー情報 -->
          <div class="flex items-center space-x-3">
            <div class="text-right">
              <div class="font-semibold">鈴木 花子</div>
              <div class="text-sm text-green-200">カスタマー部長</div>
            </div>
            <div class="w-12 h-12 bg-gradient-to-br from-white to-gray-200 text-green-800 rounded-full flex items-center justify-center font-bold text-lg">
              SH
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="container mx-auto px-4 py-6">
    <!-- パンくずナビゲーション -->
    <nav class="flex items-center space-x-2 text-sm text-gray-600 mb-6">
      <a href="#" class="hover:text-green-600 transition-colors flex items-center">
        <i class="fas fa-home mr-1"></i>
        ホーム
      </a>
      <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
      <a href="#" class="hover:text-green-600 transition-colors">カスタマー部門HUB</a>
      <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
      <span class="text-gray-800 font-semibold">設備管理台帳</span>
    </nav>

    <!-- 検索・フィルター バー -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6 card-hover">
      <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0">
        <div class="flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4">
          <!-- 検索ボックス -->
          <div class="relative">
            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            <input type="text" 
                   placeholder="設備名、型番、顧客名で検索..." 
                   class="pl-10 pr-4 py-3 border border-gray-300 rounded-lg w-80 focus:ring-2 focus:ring-green-500 focus:border-green-500"
                   id="equipmentSearch">
          </div>
          
          <!-- 顧客選択 -->
          <select class="border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 focus:border-green-500">
            <option>すべての顧客</option>
            <option>ABC製作所</option>
            <option>DEF工業</option>
            <option>GHI商事</option>
            <option>JKL産業</option>
          </select>
          
          <!-- 設備分類選択 -->
          <select class="border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 focus:border-green-500">
            <option>すべての設備</option>
            <option>空調設備</option>
            <option>電気設備</option>
            <option>給排水設備</option>
            <option>制御設備</option>
            <option>照明設備</option>
          </select>
        </div>
        
        <div class="flex items-center space-x-3">
          <!-- フィルターチップ -->
          <div class="flex items-center space-x-2">
            <button class="filter-chip active" onclick="toggleFilter(this, 'all')">すべて</button>
            <button class="filter-chip" onclick="toggleFilter(this, 'normal')">正常</button>
            <button class="filter-chip" onclick="toggleFilter(this, 'warning')">注意</button>
            <button class="filter-chip" onclick="toggleFilter(this, 'critical')">緊急</button>
            <button class="filter-chip" onclick="toggleFilter(this, 'maintenance')">メンテ中</button>
          </div>
          
          <!-- アクションボタン -->
          <button class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
            <i class="fas fa-plus mr-2"></i>設備登録
          </button>
          <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
            <i class="fas fa-download mr-2"></i>エクスポート
          </button>
        </div>
      </div>
    </div>

    <!-- 統計概要カード -->
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-6">
      <!-- 正常稼働設備 -->
      <div class="status-normal rounded-2xl p-6 card-hover">
        <div class="flex items-center justify-between mb-4">
          <div>
            <div class="text-white text-opacity-90 text-sm font-medium">正常稼働</div>
            <div class="text-3xl font-bold text-white">1,156台</div>
          </div>
          <div class="w-16 h-16 bg-white bg-opacity-20 rounded-xl flex items-center justify-center">
            <i class="fas fa-check-circle text-white text-2xl"></i>
          </div>
        </div>
        <div class="flex items-center text-white text-opacity-80 text-sm">
          <i class="fas fa-arrow-up mr-2"></i>
          <span>稼働率: 92.7%</span>
        </div>
      </div>

      <!-- 注意設備 -->
      <div class="status-warning rounded-2xl p-6 card-hover">
        <div class="flex items-center justify-between mb-4">
          <div>
            <div class="text-white text-opacity-90 text-sm font-medium">注意が必要</div>
            <div class="text-3xl font-bold text-white">67台</div>
          </div>
          <div class="w-16 h-16 bg-white bg-opacity-20 rounded-xl flex items-center justify-center">
            <i class="fas fa-exclamation-triangle text-white text-2xl"></i>
          </div>
        </div>
        <div class="flex items-center text-white text-opacity-80 text-sm">
          <i class="fas fa-clock mr-2"></i>
          <span>メンテ期限近：18台</span>
        </div>
      </div>

      <!-- 緊急対応設備 -->
      <div class="status-critical rounded-2xl p-6 card-hover">
        <div class="flex items-center justify-between mb-4">
          <div>
            <div class="text-white text-opacity-90 text-sm font-medium">緊急対応</div>
            <div class="text-3xl font-bold text-white">12台</div>
          </div>
          <div class="w-16 h-16 bg-white bg-opacity-20 rounded-xl flex items-center justify-center">
            <i class="fas fa-exclamation text-white text-2xl"></i>
          </div>
        </div>
        <div class="flex items-center text-white text-opacity-80 text-sm">
          <i class="fas fa-tools mr-2"></i>
          <span>即時対応要：5台</span>
        </div>
      </div>

      <!-- メンテナンス中 -->
      <div class="status-maintenance rounded-2xl p-6 card-hover">
        <div class="flex items-center justify-between mb-4">
          <div>
            <div class="text-white text-opacity-90 text-sm font-medium">メンテナンス中</div>
            <div class="text-3xl font-bold text-white">12台</div>
          </div>
          <div class="w-16 h-16 bg-white bg-opacity-20 rounded-xl flex items-center justify-center">
            <i class="fas fa-wrench text-white text-2xl"></i>
          </div>
        </div>
        <div class="flex items-center text-white text-opacity-80 text-sm">
          <i class="fas fa-calendar mr-2"></i>
          <span>完了予定：3台（今週）</span>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
      <!-- メインコンテンツ -->
      <div class="xl:col-span-2 space-y-6">
        
        <!-- 設備一覧 -->
        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
          <div class="flex items-center justify-between mb-6">
            <h3 class="text-xl font-bold text-gray-800 flex items-center">
              <i class="fas fa-list text-green-600 mr-2"></i>
              顧客別設備一覧
            </h3>
            <div class="flex items-center space-x-2">
              <button class="bg-gray-100 text-gray-700 px-3 py-2 rounded-lg text-sm hover:bg-gray-200">
                <i class="fas fa-th-large mr-1"></i>カード表示
              </button>
              <button class="bg-green-600 text-white px-3 py-2 rounded-lg text-sm hover:bg-green-700">
                <i class="fas fa-table mr-1"></i>テーブル表示
              </button>
            </div>
          </div>

          <!-- 設備カード表示 -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            <!-- 設備カード1 -->
            <div class="equipment-card p-4 cursor-pointer" onclick="openEquipmentDetail('EQ-2023-001')">
              <div class="flex items-start justify-between mb-3">
                <div class="flex items-center">
                  <div class="equipment-status-indicator status-good"></div>
                  <div>
                    <h4 class="font-semibold text-gray-800">高効率空調機 AC-7500EX</h4>
                    <p class="text-sm text-gray-500">ABC製作所 本社工場</p>
                  </div>
                </div>
                <span class="status-normal px-3 py-1 rounded-full text-xs font-medium">正常</span>
              </div>
              
              <div class="grid grid-cols-2 gap-4 mb-3 text-sm">
                <div>
                  <span class="text-gray-500">型番:</span>
                  <div class="font-medium">AC-7500EX-001</div>
                </div>
                <div>
                  <span class="text-gray-500">設置日:</span>
                  <div class="font-medium">2023/04/15</div>
                </div>
                <div>
                  <span class="text-gray-500">保証期限:</span>
                  <div class="font-medium text-green-600">2025/04/14</div>
                </div>
                <div>
                  <span class="text-gray-500">次回点検:</span>
                  <div class="font-medium">2025/06/15</div>
                </div>
              </div>
              
              <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                <div class="text-xs text-gray-500">
                  <i class="fas fa-thermometer-half mr-1"></i>
                  室温: 22.5°C | 設定: 23°C
                </div>
                <div class="flex space-x-2">
                  <button class="text-blue-600 hover:text-blue-800 text-xs">
                    <i class="fas fa-eye mr-1"></i>詳細
                  </button>
                  <button class="text-green-600 hover:text-green-800 text-xs">
                    <i class="fas fa-clipboard-check mr-1"></i>点検
                  </button>
                </div>
              </div>
            </div>

            <!-- 設備カード2 -->
            <div class="equipment-card p-4 cursor-pointer border-orange-300" onclick="openEquipmentDetail('EQ-2023-002')">
              <div class="flex items-start justify-between mb-3">
                <div class="flex items-center">
                  <div class="equipment-status-indicator status-caution"></div>
                  <div>
                    <h4 class="font-semibold text-gray-800">受変電設備 TR-1000</h4>
                    <p class="text-sm text-gray-500">DEF工業 第二工場</p>
                  </div>
                </div>
                <span class="status-warning px-3 py-1 rounded-full text-xs font-medium">注意</span>
              </div>
              
              <div class="grid grid-cols-2 gap-4 mb-3 text-sm">
                <div>
                  <span class="text-gray-500">型番:</span>
                  <div class="font-medium">TR-1000-HV</div>
                </div>
                <div>
                  <span class="text-gray-500">設置日:</span>
                  <div class="font-medium">2021/08/20</div>
                </div>
                <div>
                  <span class="text-gray-500">保証期限:</span>
                  <div class="font-medium text-orange-600">期限切れ</div>
                </div>
                <div>
                  <span class="text-gray-500">次回点検:</span>
                  <div class="font-medium text-orange-600">2025/05/25</div>
                </div>
              </div>
              
              <div class="maintenance-alert p-2 rounded-lg mb-3">
                <div class="text-xs text-orange-800">
                  <i class="fas fa-exclamation-triangle mr-1"></i>
                  絶縁抵抗値が基準値を下回っています（要注意）
                </div>
              </div>
              
              <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                <div class="text-xs text-gray-500">
                  <i class="fas fa-bolt mr-1"></i>
                  負荷率: 78% | 電圧: 6.6kV
                </div>
                <div class="flex space-x-2">
                  <button class="text-blue-600 hover:text-blue-800 text-xs">
                    <i class="fas fa-eye mr-1"></i>詳細
                  </button>
                  <button class="text-orange-600 hover:text-orange-800 text-xs">
                    <i class="fas fa-tools mr-1"></i>メンテ
                  </button>
                </div>
              </div>
            </div>

            <!-- 設備カード3 -->
            <div class="equipment-card p-4 cursor-pointer border-red-300" onclick="openEquipmentDetail('EQ-2023-003')">
              <div class="flex items-start justify-between mb-3">
                <div class="flex items-center">
                  <div class="equipment-status-indicator status-alert"></div>
                  <div>
                    <h4 class="font-semibold text-gray-800">制御システム CS-500</h4>
                    <p class="text-sm text-gray-500">GHI商事 物流センター</p>
                  </div>
                </div>
                <span class="status-critical px-3 py-1 rounded-full text-xs font-medium">緊急</span>
              </div>
              
              <div class="grid grid-cols-2 gap-4 mb-3 text-sm">
                <div>
                  <span class="text-gray-500">型番:</span>
                  <div class="font-medium">CS-500-AI</div>
                </div>
                <div>
                  <span class="text-gray-500">設置日:</span>
                  <div class="font-medium">2022/11/10</div>
                </div>
                <div>
                  <span class="text-gray-500">保証期限:</span>
                  <div class="font-medium text-green-600">2025/11/09</div>
                </div>
                <div>
                  <span class="text-gray-500">次回点検:</span>
                  <div class="font-medium text-red-600">要即時対応</div>
                </div>
              </div>
              
              <div class="critical-alert p-2 rounded-lg mb-3">
                <div class="text-xs text-red-800">
                  <i class="fas fa-exclamation mr-1"></i>
                  通信エラーが頻発。制御不能状態の可能性あり（緊急対応要）
                </div>
              </div>
              
              <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                <div class="text-xs text-gray-500">
                  <i class="fas fa-wifi mr-1"></i>
                  通信状態: エラー | CPU使用率: 95%
                </div>
                <div class="flex space-x-2">
                  <button class="text-blue-600 hover:text-blue-800 text-xs">
                    <i class="fas fa-eye mr-1"></i>詳細
                  </button>
                  <button class="text-red-600 hover:text-red-800 text-xs">
                    <i class="fas fa-phone mr-1"></i>緊急連絡
                  </button>
                </div>
              </div>
            </div>

            <!-- 設備カード4 -->
            <div class="equipment-card p-4 cursor-pointer" onclick="openEquipmentDetail('EQ-2023-004')">
              <div class="flex items-start justify-between mb-3">
                <div class="flex items-center">
                  <div class="equipment-status-indicator status-offline"></div>
                  <div>
                    <h4 class="font-semibold text-gray-800">LED照明システム LL-2000</h4>
                    <p class="text-sm text-gray-500">JKL産業 研究棟</p>
                  </div>
                </div>
                <span class="status-maintenance px-3 py-1 rounded-full text-xs font-medium">メンテ中</span>
              </div>
              
              <div class="grid grid-cols-2 gap-4 mb-3 text-sm">
                <div>
                  <span class="text-gray-500">型番:</span>
                  <div class="font-medium">LL-2000-SM</div>
                </div>
                <div>
                  <span class="text-gray-500">設置日:</span>
                  <div class="font-medium">2024/01/25</div>
                </div>
                <div>
                  <span class="text-gray-500">保証期限:</span>
                  <div class="font-medium text-green-600">2027/01/24</div>
                </div>
                <div>
                  <span class="text-gray-500">メンテ完了予定:</span>
                  <div class="font-medium text-blue-600">2025/05/20</div>
                </div>
              </div>
              
              <div class="bg-purple-50 border border-purple-200 p-2 rounded-lg mb-3">
                <div class="text-xs text-purple-800">
                  <i class="fas fa-wrench mr-1"></i>
                  LED基板交換作業中（進捗: 65%）
                </div>
              </div>
              
              <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                <div class="text-xs text-gray-500">
                  <i class="fas fa-lightbulb mr-1"></i>
                  消費電力: 0W（メンテ停止中）
                </div>
                <div class="flex space-x-2">
                  <button class="text-blue-600 hover:text-blue-800 text-xs">
                    <i class="fas fa-eye mr-1"></i>詳細
                  </button>
                  <button class="text-purple-600 hover:text-purple-800 text-xs">
                    <i class="fas fa-clipboard-list mr-1"></i>進捗
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- ページネーション -->
          <div class="flex items-center justify-between mt-6 pt-4 border-t border-gray-200">
            <div class="text-sm text-gray-600">
              全1,247台中 1-4台を表示
            </div>
            <div class="flex items-center space-x-2">
              <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">312</button>
              <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">
                次へ
              </button>
            </div>
          </div>
        </div>

        <!-- メンテナンス予定 -->
        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
          <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
            <i class="fas fa-calendar-check text-blue-600 mr-2"></i>
            メンテナンス予定・履歴
          </h3>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- 今週の予定 -->
            <div>
              <h4 class="font-semibold text-gray-800 mb-4">今週の予定</h4>
              <div class="space-y-3">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                  <div class="flex items-center justify-between mb-2">
                    <h5 class="font-medium text-blue-800">定期点検</h5>
                    <span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded">5/20</span>
                  </div>
                  <p class="text-sm text-blue-700">受変電設備 TR-1000 (DEF工業)</p>
                  <div class="flex items-center justify-between mt-2">
                    <span class="text-xs text-blue-600">担当: 山田技師</span>
                    <button class="text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700">
                      準備状況
                    </button>
                  </div>
                </div>
                
                <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                  <div class="flex items-center justify-between mb-2">
                    <h5 class="font-medium text-green-800">部品交換</h5>
                    <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded">5/22</span>
                  </div>
                  <p class="text-sm text-green-700">LED照明システム基板交換完了</p>
                  <div class="flex items-center justify-between mt-2">
                    <span class="text-xs text-green-600">担当: 佐藤技師</span>
                    <button class="text-xs bg-green-600 text-white px-2 py-1 rounded hover:bg-green-700">
                      進捗確認
                    </button>
                  </div>
                </div>
                
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                  <div class="flex items-center justify-between mb-2">
                    <h5 class="font-medium text-orange-800">緊急点検</h5>
                    <span class="text-xs bg-orange-100 text-orange-600 px-2 py-1 rounded">要調整</span>
                  </div>
                  <p class="text-sm text-orange-700">制御システム CS-500 通信障害調査</p>
                  <div class="flex items-center justify-between mt-2">
                    <span class="text-xs text-orange-600">担当: 未定</span>
                    <button class="text-xs bg-orange-600 text-white px-2 py-1 rounded hover:bg-orange-700">
                      担当者調整
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 最近の履歴 -->
            <div>
              <h4 class="font-semibold text-gray-800 mb-4">最近の履歴</h4>
              <div class="space-y-3">
                <div class="relative pl-8 timeline-item">
                  <div class="absolute left-0 top-2 w-4 h-4 bg-green-500 rounded-full border-2 border-white"></div>
                  <div class="bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-sm font-medium text-gray-800">定期点検完了</span>
                      <span class="text-xs text-gray-500">2025/05/15</span>
                    </div>
                    <p class="text-sm text-gray-600">高効率空調機 AC-7500EX (ABC製作所)</p>
                    <p class="text-xs text-green-600 mt-1">結果: 良好 | 担当: 田中技師</p>
                  </div>
                </div>
                
                <div class="relative pl-8 timeline-item">
                  <div class="absolute left-0 top-2 w-4 h-4 bg-yellow-500 rounded-full border-2 border-white"></div>
                  <div class="bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-sm font-medium text-gray-800">部品交換</span>
                      <span class="text-xs text-gray-500">2025/05/12</span>
                    </div>
                    <p class="text-sm text-gray-600">冷却水ポンプ インペラ交換</p>
                    <p class="text-xs text-yellow-600 mt-1">結果: 交換完了 | 担当: 高橋技師</p>
                  </div>
                </div>
                

                  <div class="bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-sm font-medium text-gray-800">性能測定</span>
                      <span class="text-xs text-gray-500">2025/05/10</span>
                    </div>
                    <p class="text-sm text-gray-600">空調システム省エネ効果測定</p>
                    <p class="text-xs text-blue-600 mt-1">結果: 目標達成 | 担当: 鈴木技師</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 右サイドバー -->
      <div class="xl:col-span-1 space-y-6">
        
        <!-- QRコードスキャナー -->
        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
          <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
            <i class="fas fa-qrcode text-purple-600 mr-2"></i>
            QRコード設備検索
          </h3>
          
          <div class="qr-scanner p-6 text-center cursor-pointer" onclick="openQRScanner()">
            <i class="fas fa-qrcode text-4xl text-gray-400 mb-3"></i>
            <p class="text-sm text-gray-600 mb-2">設備のQRコードをスキャン</p>
            <button class="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-purple-700">
              <i class="fas fa-camera mr-1"></i>スキャン開始
            </button>
          </div>
          
          <!-- クイック検索 -->
          <div class="mt-4 p-4 bg-gray-50 rounded-lg">
            <h4 class="font-medium text-gray-800 mb-2">クイック検索</h4>
            <input type="text" 
                   placeholder="設備ID入力 (例: EQ-2023-001)" 
                   class="w-full border border-gray-300 rounded px-3 py-2 text-sm mb-2">
            <button class="w-full bg-gray-600 text-white px-4 py-2 rounded text-sm hover:bg-gray-700">
              <i class="fas fa-search mr-1"></i>検索
            </button>
          </div>
        </div>

        <!-- 保証期間管理 -->
        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
          <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
            <i class="fas fa-shield-alt text-blue-600 mr-2"></i>
            保証期間管理
          </h3>
          
          <div class="space-y-4">
            <!-- 保証状況サマリー -->
            <div class="text-center">
              <div class="relative w-20 h-20 mx-auto mb-2 warranty-gauge">
                <div class="absolute inset-0 flex items-center justify-center">
                  <span class="text-lg font-bold text-gray-800">78%</span>
                </div>
              </div>
              <div class="text-sm text-gray-600">保証期間内設備</div>
              <div class="text-xs text-blue-600">973台 / 1,247台</div>
            </div>
            
            <!-- 期限切れ間近 -->
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
              <h4 class="font-medium text-yellow-800 mb-2">期限切れ間近（3ヶ月以内）</h4>
              <div class="space-y-2">
                <div class="flex items-center justify-between text-sm">
                  <span class="text-gray-700">受変電設備</span>
                  <span class="text-yellow-600 font-medium">2025/08/20</span>
                </div>
                <div class="flex items-center justify-between text-sm">
                  <span class="text-gray-700">制御システム</span>
                  <span class="text-yellow-600 font-medium">2025/07/15</span>
                </div>
                <div class="flex items-center justify-between text-sm">
                  <span class="text-gray-700">照明設備</span>
                  <span class="text-yellow-600 font-medium">2025/06/30</span>
                </div>
              </div>
              <button class="w-full mt-3 bg-yellow-600 text-white px-4 py-2 rounded text-sm hover:bg-yellow-700">
                <i class="fas fa-bell mr-1"></i>延長手続き確認
              </button>
            </div>
            
            <!-- 期限切れ -->
            <div class="bg-red-50 border border-red-200 rounded-lg p-3">
              <h4 class="font-medium text-red-800 mb-2">期限切れ設備</h4>
              <div class="text-center">
                <div class="text-2xl font-bold text-red-600">18台</div>
                <div class="text-xs text-red-600">要対応</div>
              </div>
              <button class="w-full mt-3 bg-red-600 text-white px-4 py-2 rounded text-sm hover:bg-red-700">
                <i class="fas fa-exclamation-triangle mr-1"></i>対応状況確認
              </button>
            </div>
          </div>
        </div>

        <!-- 部品在庫管理 -->
        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
          <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
            <i class="fas fa-boxes text-indigo-600 mr-2"></i>
            部品在庫管理
          </h3>
          
          <div class="space-y-4">
            <!-- 在庫アラート -->
            <div class="parts-inventory p-4">
              <h4 class="font-medium text-blue-800 mb-3">在庫アラート</h4>
              <div class="space-y-2">
                <div class="flex items-center justify-between p-2 bg-white rounded border">
                  <div class="text-sm">
                    <div class="font-medium">インペラ（CR-500用）</div>
                    <div class="text-gray-500">在庫: 2個</div>
                  </div>
                  <span class="bg-yellow-100 text-yellow-600 px-2 py-1 rounded text-xs">低在庫</span>
                </div>
                
                <div class="flex items-center justify-between p-2 bg-white rounded border">
                  <div class="text-sm">
                    <div class="font-medium">LED基板</div>
                    <div class="text-gray-500">在庫: 0個</div>
                  </div>
                  <span class="bg-red-100 text-red-600 px-2 py-1 rounded text-xs">欠品</span>
                </div>
                
                <div class="flex items-center justify-between p-2 bg-white rounded border">
                  <div class="text-sm">
                    <div class="font-medium">制御基板（CS-500用）</div>
                    <div class="text-gray-500">在庫: 1個</div>
                  </div>
                  <span class="bg-yellow-100 text-yellow-600 px-2 py-1 rounded text-xs">低在庫</span>
                </div>
              </div>
            </div>
            
            <!-- 発注状況 -->
            <div>
              <h4 class="font-medium text-gray-800 mb-3">発注状況</h4>
              <div class="space-y-2">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-2">
                  <div class="text-sm font-medium text-blue-800">LED基板セット</div>
                  <div class="text-xs text-blue-600">発注済 | 納期: 2025/05/25</div>
                </div>
                
                <div class="bg-green-50 border border-green-200 rounded-lg p-2">
                  <div class="text-sm font-medium text-green-800">インペラ 10個</div>
                  <div class="text-xs text-green-600">納品済 | 入庫待ち</div>
                </div>
              </div>
            </div>
            
            <!-- アクションボタン -->
            <div class="grid grid-cols-2 gap-2">
              <button class="bg-indigo-600 text-white px-3 py-2 rounded text-sm hover:bg-indigo-700">
                <i class="fas fa-plus mr-1"></i>発注登録
              </button>
              <button class="bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700">
                <i class="fas fa-list mr-1"></i>在庫一覧
              </button>
            </div>
          </div>
        </div>

        <!-- 活動履歴連携 -->
        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
          <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
            <i class="fas fa-history text-green-600 mr-2"></i>
            最近の活動履歴
          </h3>
          
          <div class="space-y-3">
            <!-- 設備関連活動 -->
            <div class="bg-green-50 border border-green-200 rounded-lg p-3">
              <div class="flex items-start space-x-3">
                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                  <i class="fas fa-tools text-white text-sm"></i>
                </div>
                <div class="flex-1">
                  <div class="text-sm font-medium text-green-800">設備点検完了</div>
                  <div class="text-xs text-green-600 mt-1">
                    高効率空調機 AC-7500EX | ABC製作所
                    <br>実施者: 田中技師 | 2025/05/15 14:30
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
              <div class="flex items-start space-x-3">
                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                  <i class="fas fa-wrench text-white text-sm"></i>
                </div>
                <div class="flex-1">
                  <div class="text-sm font-medium text-blue-800">部品交換実施</div>
                  <div class="text-xs text-blue-600 mt-1">
                    冷却水ポンプ インペラ | DEF工業
                    <br>実施者: 高橋技師 | 2025/05/12 10:15
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
              <div class="flex items-start space-x-3">
                <div class="w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center">
                  <i class="fas fa-exclamation-triangle text-white text-sm"></i>
                </div>
                <div class="flex-1">
                  <div class="text-sm font-medium text-orange-800">異常検知アラート</div>
                  <div class="text-xs text-orange-600 mt-1">
                    制御システム CS-500 | GHI商事
                    <br>検知時刻: 2025/05/18 08:30
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-purple-50 border border-purple-200 rounded-lg p-3">
              <div class="flex items-start space-x-3">
                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center">
                  <i class="fas fa-file-alt text-white text-sm"></i>
                </div>
                <div class="flex-1">
                  <div class="text-sm font-medium text-purple-800">報告書作成</div>
                  <div class="text-xs text-purple-600 mt-1">
                    月次点検報告書 | 2025年4月分
                    <br>作成者: 鈴木部長 | 2025/05/10 16:45
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 活動履歴連携ボタン -->
          <div class="mt-4 p-3 bg-gray-50 rounded-lg">
            <button class="w-full bg-gray-600 text-white px-4 py-2 rounded text-sm hover:bg-gray-700">
              <i class="fas fa-external-link-alt mr-1"></i>
              全社活動履歴システムを開く
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 設備詳細モーダル -->
  <div id="equipmentDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
    <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
      <!-- モーダルヘッダー -->
      <div class="flex items-center justify-between p-6 border-b border-gray-200">
        <h3 class="text-xl font-bold text-gray-800">設備詳細情報</h3>
        <button onclick="closeEquipmentDetail()" class="text-gray-400 hover:text-gray-600">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>
      
      <!-- モーダルコンテンツ -->
      <div class="p-6">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- 基本情報 -->
          <div class="space-y-6">
            <div>
              <h4 class="text-lg font-semibold text-gray-800 mb-4">基本情報</h4>
              <div class="specification-grid">
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-sm text-gray-500">設備名</div>
                  <div class="font-semibold text-gray-800" id="equipmentName">高効率空調機 AC-7500EX</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-sm text-gray-500">型番</div>
                  <div class="font-semibold text-gray-800" id="equipmentModel">AC-7500EX-001</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-sm text-gray-500">設置場所</div>
                  <div class="font-semibold text-gray-800" id="equipmentLocation">ABC製作所 本社工場</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-sm text-gray-500">設置日</div>
                  <div class="font-semibold text-gray-800" id="installDate">2023/04/15</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-sm text-gray-500">製造者</div>
                  <div class="font-semibold text-gray-800" id="manufacturer">XYZ空調システム</div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-sm text-gray-500">設備ID</div>
                  <div class="font-semibold text-gray-800" id="equipmentId">EQ-2023-001</div>
                </div>
              </div>
            </div>
            
            <!-- 技術仕様 -->
            <div>
              <h4 class="text-lg font-semibold text-gray-800 mb-4">技術仕様</h4>
              <div class="specification-grid">
                <div class="bg-blue-50 p-4 rounded-lg">
                  <div class="text-sm text-blue-600">冷房能力</div>
                  <div class="font-semibold text-blue-800">75kW</div>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                  <div class="text-sm text-blue-600">消費電力</div>
                  <div class="font-semibold text-blue-800">18.5kW</div>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                  <div class="text-sm text-blue-600">電源</div>
                  <div class="font-semibold text-blue-800">3φ 200V 50Hz</div>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                  <div class="text-sm text-blue-600">冷媒</div>
                  <div class="font-semibold text-blue-800">R410A</div>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                  <div class="text-sm text-blue-600">COP</div>
                  <div class="font-semibold text-blue-800">4.05</div>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                  <div class="text-sm text-blue-600">騒音値</div>
                  <div class="font-semibold text-blue-800">52dB(A)</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 状態・履歴 -->
          <div class="space-y-6">
            <!-- 現在の状態 -->
            <div>
              <h4 class="text-lg font-semibold text-gray-800 mb-4">現在の状態</h4>
              <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                <div class="flex items-center mb-3">
                  <div class="equipment-status-indicator status-good mr-2"></div>
                  <span class="font-semibold text-green-800">正常稼働中</span>
                </div>
                <div class="grid grid-cols-2 gap-4 text-sm">
                  <div>
                    <span class="text-gray-500">室温:</span>
                    <span class="font-medium text-gray-800 ml-1">22.5°C</span>
                  </div>
                  <div>
                    <span class="text-gray-500">設定温度:</span>
                    <span class="font-medium text-gray-800 ml-1">23°C</span>
                  </div>
                  <div>
                    <span class="text-gray-500">消費電力:</span>
                    <span class="font-medium text-gray-800 ml-1">16.2kW</span>
                  </div>
                  <div>
                    <span class="text-gray-500">稼働率:</span>
                    <span class="font-medium text-gray-800 ml-1">87%</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 保証・メンテナンス -->
            <div>
              <h4 class="text-lg font-semibold text-gray-800 mb-4">保証・メンテナンス</h4>
              <div class="space-y-3">
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-sm text-gray-600">保証期間</span>
                    <span class="font-semibold text-green-600">2025/04/14まで</span>
                  </div>
                  <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="bg-green-500 h-2 rounded-full" style="width: 65%"></div>
                  </div>
                  <div class="text-xs text-gray-500 mt-1">残り10ヶ月</div>
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-sm text-gray-600">前回点検</span>
                    <span class="font-semibold text-gray-800">2025/05/15</span>
                  </div>
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600">次回点検予定</span>
                    <span class="font-semibold text-blue-600">2025/06/15</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 最近の履歴 -->
            <div>
              <h4 class="text-lg font-semibold text-gray-800 mb-4">メンテナンス履歴</h4>
              <div class="space-y-3 max-h-48 overflow-y-auto">
                <div class="relative pl-8 timeline-item">
                  <div class="absolute left-0 top-2 w-4 h-4 bg-green-500 rounded-full border-2 border-white"></div>
                  <div class="bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-sm font-medium text-gray-800">定期点検</span>
                      <span class="text-xs text-gray-500">2025/05/15</span>
                    </div>
                    <p class="text-sm text-gray-600">冷媒圧力、電気系統、フィルター状況確認</p>
                    <p class="text-xs text-green-600 mt-1">結果: 良好 | 担当: 田中技師</p>
                  </div>
                </div>
                
                <div class="relative pl-8 timeline-item">
                  <div class="absolute left-0 top-2 w-4 h-4 bg-blue-500 rounded-full border-2 border-white"></div>
                  <div class="bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-sm font-medium text-gray-800">フィルター交換</span>
                      <span class="text-xs text-gray-500">2025/03/20</span>
                    </div>
                    <p class="text-sm text-gray-600">エアフィルター全数交換実施</p>
                    <p class="text-xs text-blue-600 mt-1">結果: 交換完了 | 担当: 高橋技師</p>
                  </div>
                </div>
                
                <div class="relative pl-8 timeline-item">
                  <div class="absolute left-0 top-2 w-4 h-4 bg-yellow-500 rounded-full border-2 border-white"></div>
                  <div class="bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-sm font-medium text-gray-800">冷媒補充</span>
                      <span class="text-xs text-gray-500">2025/02/10</span>
                    </div>
                    <p class="text-sm text-gray-600">冷媒量低下により補充作業実施</p>
                    <p class="text-xs text-yellow-600 mt-1">結果: 補充完了 | 担当: 山田技師</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 部品交換履歴 -->
        <div class="mt-6">
          <h4 class="text-lg font-semibold text-gray-800 mb-4">部品交換履歴</h4>
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-gray-200">
                  <th class="text-left py-2 font-medium text-gray-700">交換日</th>
                  <th class="text-left py-2 font-medium text-gray-700">部品名</th>
                  <th class="text-left py-2 font-medium text-gray-700">部品番号</th>
                  <th class="text-left py-2 font-medium text-gray-700">数量</th>
                  <th class="text-left py-2 font-medium text-gray-700">交換理由</th>
                  <th class="text-left py-2 font-medium text-gray-700">担当者</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-b border-gray-100">
                  <td class="py-2">2025/03/20</td>
                  <td class="py-2">エアフィルター</td>
                  <td class="py-2">AF-7500-001</td>
                  <td class="py-2">4枚</td>
                  <td class="py-2">定期交換</td>
                  <td class="py-2">高橋技師</td>
                </tr>
                <tr class="border-b border-gray-100">
                  <td class="py-2">2024/11/15</td>
                  <td class="py-2">圧縮機オイル</td>
                  <td class="py-2">OIL-7500-002</td>
                  <td class="py-2">20L</td>
                  <td class="py-2">定期交換</td>
                  <td class="py-2">田中技師</td>
                </tr>
                <tr class="border-b border-gray-100">
                  <td class="py-2">2024/08/10</td>
                  <td class="py-2">制御基板</td>
                  <td class="py-2">PCB-7500-003</td>
                  <td class="py-2">1枚</td>
                  <td class="py-2">故障交換</td>
                  <td class="py-2">山田技師</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- アクションボタン -->
        <div class="mt-6 flex flex-wrap gap-3">
          <button class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
            <i class="fas fa-clipboard-check mr-1"></i>点検登録
          </button>
          <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
            <i class="fas fa-wrench mr-1"></i>メンテナンス登録
          </button>
          <button class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">
            <i class="fas fa-exchange-alt mr-1"></i>部品交換登録
          </button>
          <button class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700">
            <i class="fas fa-file-alt mr-1"></i>報告書作成
          </button>
          <button class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
            <i class="fas fa-edit mr-1"></i>設備情報編集
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- QRスキャナーモーダル -->
  <div id="qrScannerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-bold text-gray-800">QRコードスキャナー</h3>
        <button onclick="closeQRScanner()" class="text-gray-400 hover:text-gray-600">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="text-center">
        <div class="bg-gray-100 rounded-lg p-8 mb-4">
          <i class="fas fa-camera text-6xl text-gray-400 mb-4"></i>
          <p class="text-gray-600">カメラでQRコードを読み取ってください</p>
        </div>
        
        <div class="space-y-3">
          <button class="w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">
            <i class="fas fa-camera mr-2"></i>カメラを起動
          </button>
          <button class="w-full bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
            <i class="fas fa-upload mr-2"></i>画像ファイルから読み取り
          </button>
        </div>
        
        <div class="mt-4 p-3 bg-blue-50 rounded-lg">
          <p class="text-sm text-blue-700">
            <i class="fas fa-info-circle mr-1"></i>
            設備に貼られているQRコードを読み取ると、該当設備の詳細情報が表示されます
          </p>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // ページ読み込み時の初期化
      initializeCharts();
      addEventHandlers();
      loadEquipmentData();
      
      // 自動更新設定
      setInterval(updateRealTimeData, 30000); // 30秒ごと
      
      // ウェルカムメッセージ
      setTimeout(() => {
        showNotification('設備管理台帳システムにアクセスしました。メンテナンス期限が近い設備が5台あります。', 'info');
      }, 1000);
    });

    function initializeCharts() {
      // 保証期間ゲージの初期化
      const warrantyGauges = document.querySelectorAll('.warranty-gauge');
      warrantyGauges.forEach(gauge => {
        // CSSアニメーションで初期化
        gauge.style.animation = 'warranty-fill 1s ease-in-out';
      });
    }

    function addEventHandlers() {
      // 検索機能
      const searchInput = document.getElementById('equipmentSearch');
      if (searchInput) {
        searchInput.addEventListener('input', debounce(performSearch, 300));
      }

      // フィルターチップ
      const filterChips = document.querySelectorAll('.filter-chip');
      filterChips.forEach(chip => {
        chip.addEventListener('click', function() {
          toggleFilter(this, this.textContent.trim());
        });
      });

      // 設備カードのホバー効果
      const equipmentCards = document.querySelectorAll('.equipment-card');
      equipmentCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-4px)';
        });
        card.addEventListener('mouseleave', function() {
          this.style.transform = 'translateY(0)';
        });
      });
    }

    function loadEquipmentData() {
      // 模擬的な設備データ読み込み
      const equipmentData = [
        {
          id: 'EQ-2023-001',
          name: '高効率空調機 AC-7500EX',
          model: 'AC-7500EX-001',
          location: 'ABC製作所 本社工場',
          status: 'normal',
          installDate: '2023/04/15',
          warrantyEnd: '2025/04/14',
          lastMaintenance: '2025/05/15',
          nextMaintenance: '2025/06/15'
        },
        // 他の設備データ...
      ];

      // データ表示の更新
      updateEquipmentDisplay(equipmentData);
    }

    function updateEquipmentDisplay(data) {
      // 統計カードの更新
      updateStatistics(data);
      
      // 設備カードの更新
      updateEquipmentCards(data);
    }

    function updateStatistics(data) {
      const normalCount = data.filter(eq => eq.status === 'normal').length;
      const warningCount = data.filter(eq => eq.status === 'warning').length;
      const criticalCount = data.filter(eq => eq.status === 'critical').length;
      const maintenanceCount = data.filter(eq => eq.status === 'maintenance').length;

      // 各統計カードを更新
      // 実際の実装では DOM要素を選択して値を更新
    }

    function updateEquipmentCards(data) {
      // 設備カードの動的生成・更新
      // 実際の実装では data を基にカードHTMLを生成
    }

    function performSearch() {
      const searchTerm = document.getElementById('equipmentSearch').value.toLowerCase();
      const equipmentCards = document.querySelectorAll('.equipment-card');
      
      equipmentCards.forEach(card => {
        const equipmentName = card.querySelector('h4').textContent.toLowerCase();
        const location = card.querySelector('.text-gray-500').textContent.toLowerCase();
        
        if (equipmentName.includes(searchTerm) || location.includes(searchTerm)) {
          card.style.display = 'block';
          card.style.animation = 'fadeIn 0.3s ease-in-out';
        } else {
          card.style.display = 'none';
        }
      });
      
      if (searchTerm) {
        showNotification(`"${searchTerm}" で検索しました`, 'info');
      }
    }

    function toggleFilter(element, filterType) {
      // 既存のアクティブ状態をクリア
      document.querySelectorAll('.filter-chip').forEach(chip => {
        chip.classList.remove('active');
      });
      
      // 選択されたフィルターをアクティブに
      element.classList.add('active');
      
      // フィルター適用
      applyFilter(filterType);
    }

    function applyFilter(filterType) {
      const equipmentCards = document.querySelectorAll('.equipment-card');
      
      equipmentCards.forEach(card => {
        const statusBadge = card.querySelector('.status-normal, .status-warning, .status-critical, .status-maintenance');
        let shouldShow = true;
        
        if (filterType !== 'all') {
          const statusClasses = {
            'normal': 'status-normal',
            'warning': 'status-warning', 
            'critical': 'status-critical',
            'maintenance': 'status-maintenance'
          };
          
          shouldShow = statusBadge && statusBadge.classList.contains(statusClasses[filterType]);
        }
        
        if (shouldShow) {
          card.style.display = 'block';
          card.style.animation = 'slideIn 0.3s ease-out';
        } else {
          card.style.display = 'none';
        }
      });
      
      showNotification(`${filterType === 'all' ? 'すべて' : filterType}の設備でフィルタリングしました`, 'success');
    }

    function updateRealTimeData() {
      // リアルタイムデータ更新
      const statusIndicators = document.querySelectorAll('.equipment-status-indicator');
      statusIndicators.forEach(indicator => {
        // 模擬的な状態変化
        if (Math.random() < 0.05) { // 5%の確率で状態変化
          const statuses = ['status-good', 'status-caution', 'status-alert'];
          const currentStatus = indicator.className.split(' ').find(cls => cls.startsWith('status-'));
          const newStatus = statuses[Math.floor(Math.random() * statuses.length)];
          
          if (currentStatus !== newStatus) {
            indicator.classList.remove(currentStatus);
            indicator.classList.add(newStatus);
            
            // 変化を通知
            const equipmentCard = indicator.closest('.equipment-card');
            const equipmentName = equipmentCard.querySelector('h4').textContent;
            showNotification(`${equipmentName}の状態が変化しました`, 'warning');
          }
        }
      });
    }

    // 設備詳細モーダル関連
    function openEquipmentDetail(equipmentId) {
      // 設備IDに基づいて詳細情報を取得・表示
      document.getElementById('equipmentDetailModal').classList.remove('hidden');
      document.getElementById('equipmentDetailModal').classList.add('flex');
      
      // 設備詳細情報の読み込み
      loadEquipmentDetails(equipmentId);
      
      // ボディのスクロールを無効化
      document.body.style.overflow = 'hidden';
    }

    function closeEquipmentDetail() {
      document.getElementById('equipmentDetailModal').classList.add('hidden');
      document.getElementById('equipmentDetailModal').classList.remove('flex');
      
      // ボディのスクロールを復活
      document.body.style.overflow = 'auto';
    }

    function loadEquipmentDetails(equipmentId) {
      // 実際の実装では API から詳細データを取得
      const equipmentDetails = {
        'EQ-2023-001': {
          name: '高効率空調機 AC-7500EX',
          model: 'AC-7500EX-001',
          location: 'ABC製作所 本社工場',
          installDate: '2023/04/15',
          manufacturer: 'XYZ空調システム',
          id: 'EQ-2023-001'
        }
        // 他の設備詳細...
      };
      
      const details = equipmentDetails[equipmentId];
      if (details) {
        // モーダル内の要素を更新
        document.getElementById('equipmentName').textContent = details.name;
        document.getElementById('equipmentModel').textContent = details.model;
        document.getElementById('equipmentLocation').textContent = details.location;
        document.getElementById('installDate').textContent = details.installDate;
        document.getElementById('manufacturer').textContent = details.manufacturer;
        document.getElementById('equipmentId').textContent = details.id;
      }
    }

    // QRスキャナー関連
    function openQRScanner() {
      document.getElementById('qrScannerModal').classList.remove('hidden');
      document.getElementById('qrScannerModal').classList.add('flex');
    }

    function closeQRScanner() {
      document.getElementById('qrScannerModal').classList.add('hidden');
      document.getElementById('qrScannerModal').classList.remove('flex');
    }

    // ユーティリティ関数
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // 通知表示関数
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      const bgColor = {
        'success': 'bg-green-500',
        'warning': 'bg-yellow-500',
        'error': 'bg-red-500',
        'info': 'bg-blue-500'
      }[type] || 'bg-blue-500';
      
      const icon = {
        'success': 'fas fa-check-circle',
        'warning': 'fas fa-exclamation-triangle',
        'error': 'fas fa-times-circle',
        'info': 'fas fa-info-circle'
      }[type] || 'fas fa-info-circle';
      
      notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-4 rounded-lg shadow-lg z-50 transform transition-all duration-300 max-w-sm`;
      notification.innerHTML = `
        <div class="flex items-center">
          <i class="${icon} mr-3"></i>
          <span>${message}</span>
        </div>
      `;
      notification.style.transform = 'translateX(100%)';
      
      document.body.appendChild(notification);
      
      // アニメーション
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);
      
      // 自動削除
      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 300);
      }, 4000);
    }

    // キーボードショートカット
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey || e.metaKey) {
        switch(e.key) {
          case 'f': // Ctrl+F で検索
            e.preventDefault();
            document.getElementById('equipmentSearch')?.focus();
            break;
          case 'q': // Ctrl+Q でQRスキャナー
            e.preventDefault();
            openQRScanner();
            break;
          case 'r': // Ctrl+R でリアルタイム更新
            e.preventDefault();
            updateRealTimeData();
            showNotification('データを更新しました', 'success');
            break;
        }
      }
      
      // ESCキーでモーダルを閉じる
      if (e.key === 'Escape') {
        closeEquipmentDetail();
        closeQRScanner();
      }
    });

    // ページ離脱時の確認
    window.addEventListener('beforeunload', function(e) {
      const openModals = document.querySelectorAll('.fixed:not(.hidden)');
      if (openModals.length > 0) {
        e.preventDefault();
        e.returnValue = '';
      }
    });

    // タブの可視性変更時の処理
    document.addEventListener('visibilitychange', function() {
      if (!document.hidden) {
        // タブがアクティブになった時にデータを更新
        updateRealTimeData();
      }
    });

    // CSS アニメーション定義
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      
      @keyframes slideIn {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      
      @keyframes warranty-fill {
        from { transform: rotate(-90deg) scale(0.8); }
        to { transform: rotate(-90deg) scale(1); }
      }
      
      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>
                  sm hover:bg-gray-50">
                前へ
              </button>
              <button class="px-3 py-2 bg-green-600 text-white rounded-lg text-sm">1</button>
              <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">2</button>
              <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">3</button>
              <span class="px-2 text-gray-500">...</span>
              <button class="px-3 py-2 border border-gray-300 rounded-lg text-